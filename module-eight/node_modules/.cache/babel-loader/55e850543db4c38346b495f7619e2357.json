{"ast":null,"code":"import _toConsumableArray from\"/home/analimazn/Projetos/react-projects/codenation-react-dev/eight-module/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/analimazn/Projetos/react-projects/codenation-react-dev/eight-module/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import Stories from'../../containers/Stories';import Posts from'../../containers/Posts';import Loading from'../../components/Loading';import'./FeedRoute.scss';var FeedRoute=function FeedRoute(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),users=_useState2[0],setUsers=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),posts=_useState4[0],setPosts=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),stories=_useState6[0],setStories=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),index=_useState8[0],setIndex=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),loading=_useState10[0],setLoading=_useState10[1];useEffect(function(){fetch('https://5e7d0266a917d70016684219.mockapi.io/api/v1/users').then(function(res){return res.json();}).then(function(data){return setUsers(data);});},[]);useEffect(function(){fetch('https://5e7d0266a917d70016684219.mockapi.io/api/v1/stories').then(function(res){return res.json();}).then(function(data){return setStories(data);});},[]);useEffect(function(){if(index===users.length){setLoading(false);return;}if(index<=users.length){fetch(\"https://5e7d0266a917d70016684219.mockapi.io/api/v1/users/\".concat(users[index].id,\"/posts\")).then(function(res){return res.json();}).then(function(data){setPosts([].concat(_toConsumableArray(posts),_toConsumableArray(data)));setIndex(index+1);});}},[index,users,posts]);var getUserHandler=function getUserHandler(id){return users.find(function(user){return user.id===id;});};return/*#__PURE__*/React.createElement(\"div\",{\"data-testid\":\"feed-route\"},users&&stories&&/*#__PURE__*/React.createElement(Stories,{stories:stories,getUserHandler:getUserHandler}),loading?/*#__PURE__*/React.createElement(Loading,null):users&&posts&&/*#__PURE__*/React.createElement(Posts,{posts:posts,getUserHandler:getUserHandler}));};export default FeedRoute;","map":{"version":3,"sources":["/home/analimazn/Projetos/react-projects/codenation-react-dev/eight-module/src/routes/FeedRoute/FeedRoute.jsx"],"names":["React","useState","useEffect","Stories","Posts","Loading","FeedRoute","users","setUsers","posts","setPosts","stories","setStories","index","setIndex","loading","setLoading","fetch","then","res","json","data","length","id","getUserHandler","find","user"],"mappings":"wYAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CAEA,MAAOC,CAAAA,OAAP,KAAoB,0BAApB,CACA,MAAOC,CAAAA,KAAP,KAAkB,wBAAlB,CAEA,MAAOC,CAAAA,OAAP,KAAoB,0BAApB,CAEA,MAAO,kBAAP,CAEA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,eACIL,QAAQ,CAAC,EAAD,CADZ,wCACfM,KADe,eACRC,QADQ,8BAEIP,QAAQ,CAAC,EAAD,CAFZ,yCAEfQ,KAFe,eAERC,QAFQ,8BAGQT,QAAQ,CAAC,EAAD,CAHhB,yCAGfU,OAHe,eAGNC,UAHM,8BAIIX,QAAQ,CAAC,CAAD,CAJZ,yCAIfY,KAJe,eAIRC,QAJQ,8BAKQb,QAAQ,CAAC,IAAD,CALhB,0CAKfc,OALe,gBAKNC,UALM,gBAOtBd,SAAS,CAAC,UAAM,CACde,KAAK,CAAC,0DAAD,CAAL,CACGC,IADH,CACQ,SAAAC,GAAG,QAAIA,CAAAA,GAAG,CAACC,IAAJ,EAAJ,EADX,EAEGF,IAFH,CAEQ,SAAAG,IAAI,QAAIb,CAAAA,QAAQ,CAACa,IAAD,CAAZ,EAFZ,EAGD,CAJQ,CAIN,EAJM,CAAT,CAMAnB,SAAS,CAAC,UAAM,CACde,KAAK,CAAC,4DAAD,CAAL,CACGC,IADH,CACQ,SAAAC,GAAG,QAAIA,CAAAA,GAAG,CAACC,IAAJ,EAAJ,EADX,EAEGF,IAFH,CAEQ,SAAAG,IAAI,QAAIT,CAAAA,UAAU,CAACS,IAAD,CAAd,EAFZ,EAGD,CAJQ,CAIN,EAJM,CAAT,CAMAnB,SAAS,CAAC,UAAM,CACd,GAAIW,KAAK,GAAKN,KAAK,CAACe,MAApB,CAA4B,CAC1BN,UAAU,CAAC,KAAD,CAAV,CACA,OACD,CAED,GAAIH,KAAK,EAAIN,KAAK,CAACe,MAAnB,CAA2B,CACzBL,KAAK,oEAA6DV,KAAK,CAACM,KAAD,CAAL,CAAaU,EAA1E,WAAL,CACCL,IADD,CACM,SAAAC,GAAG,QAAIA,CAAAA,GAAG,CAACC,IAAJ,EAAJ,EADT,EAECF,IAFD,CAEM,SAAAG,IAAI,CAAI,CACZX,QAAQ,8BAAKD,KAAL,qBAAeY,IAAf,GAAR,CACAP,QAAQ,CAACD,KAAK,CAAG,CAAT,CAAR,CACD,CALD,EAMD,CACF,CAdQ,CAcN,CAACA,KAAD,CAAQN,KAAR,CAAeE,KAAf,CAdM,CAAT,CAgBA,GAAMe,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAAAD,EAAE,QAAIhB,CAAAA,KAAK,CAACkB,IAAN,CAAW,SAAAC,IAAI,QAAIA,CAAAA,IAAI,CAACH,EAAL,GAAYA,EAAhB,EAAf,CAAJ,EAAzB,CAEA,mBACE,2BAAK,cAAY,YAAjB,EACIhB,KAAK,EAAII,OAAV,eAAuB,oBAAC,OAAD,EAAS,OAAO,CAAEA,OAAlB,CAA2B,cAAc,CAAEa,cAA3C,EAD1B,CAEGT,OAAO,cACJ,oBAAC,OAAD,MADI,CAEHR,KAAK,EAAIE,KAAV,eAAoB,oBAAC,KAAD,EAAO,KAAK,CAAEA,KAAd,CAAqB,cAAc,CAAEe,cAArC,EAJ1B,CADF,CASD,CA9CD,CAgDA,cAAelB,CAAAA,SAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\n\nimport Stories from '../../containers/Stories';\nimport Posts from '../../containers/Posts';\n\nimport Loading from '../../components/Loading';\n\nimport './FeedRoute.scss';\n\nconst FeedRoute = () => {\n  const [users, setUsers] = useState({})\n  const [posts, setPosts] = useState([])\n  const [stories, setStories] = useState([])\n  const [index, setIndex] = useState(0)\n  const [loading, setLoading] = useState(true)\n\n  useEffect(() => {\n    fetch('https://5e7d0266a917d70016684219.mockapi.io/api/v1/users')\n      .then(res => res.json())\n      .then(data => setUsers(data))\n  }, [])\n\n  useEffect(() => {\n    fetch('https://5e7d0266a917d70016684219.mockapi.io/api/v1/stories')\n      .then(res => res.json())\n      .then(data => setStories(data))\n  }, [])\n\n  useEffect(() => {\n    if (index === users.length) {\n      setLoading(false)\n      return\n    }\n\n    if (index <= users.length) {\n      fetch(`https://5e7d0266a917d70016684219.mockapi.io/api/v1/users/${users[index].id}/posts`)\n      .then(res => res.json())\n      .then(data => {\n        setPosts([...posts, ...data])\n        setIndex(index + 1)\n      })\n    }\n  }, [index, users, posts])\n  \n  const getUserHandler = id => users.find(user => user.id === id)\n\n  return (\n    <div data-testid=\"feed-route\">\n      {(users && stories) && (<Stories stories={stories} getUserHandler={getUserHandler} />)}\n      {loading\n        ? <Loading/>\n        : (users && posts) && <Posts posts={posts} getUserHandler={getUserHandler}/>\n      }\n    </div>\n  );\n};\n\nexport default FeedRoute;\n"]},"metadata":{},"sourceType":"module"}